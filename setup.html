<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Setup</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Documint</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="actions.html"><div class="inner"><span>Actions</span></div></a></li><li class="depth-1 "><a href="clients.html"><div class="inner"><span>Client integrations</span></div></a></li><li class="depth-1 "><a href="http.html"><div class="inner"><span>HTTP API</span></div></a></li><li class="depth-1  current"><a href="setup.html"><div class="inner"><span>Setup</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>documint</span></div></div></li><li class="depth-2"><a href="documint.actions.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>actions</span></div></a></li><li class="depth-3 branch"><a href="documint.actions.interfaces.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interfaces</span></div></a></li><li class="depth-3"><a href="documint.actions.pdf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pdf</span></div></a></li><li class="depth-2 branch"><a href="documint.config.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="documint.content.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>content</span></div></a></li><li class="depth-2 branch"><a href="documint.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="documint.metrics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>metrics</span></div></a></li><li class="depth-2"><a href="documint.pdf.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pdf</span></div></a></li><li class="depth-3 branch"><a href="documint.pdf.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-3 branch"><a href="documint.pdf.crush.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>crush</span></div></a></li><li class="depth-3 branch"><a href="documint.pdf.signing.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>signing</span></div></a></li><li class="depth-3"><a href="documint.pdf.stamp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stamp</span></div></a></li><li class="depth-2"><a href="documint.render.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>render</span></div></a></li><li class="depth-3"><a href="documint.render.flying-saucer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>flying-saucer</span></div></a></li><li class="depth-2 branch"><a href="documint.schema.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>schema</span></div></a></li><li class="depth-2 branch"><a href="documint.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-2 branch"><a href="documint.systems.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>systems</span></div></a></li><li class="depth-2 branch"><a href="documint.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-2"><a href="documint.web.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>web</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -610px;"><span class="top" style="height: 619px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#setup" name="setup"></a>Setup</h1>
<h2><a href="#requirements" name="requirements"></a>Requirements</h2>
<ul>
  <li>Install Java Runtime Environment 8.</li>
  <li>Install <a href="http://boot-clj.com/">Boot</a>.</li>
  <li>Install <a href="https://leiningen.org/#install">Leiningen</a> (for building the uberjar and documentation).</li>
  <li>Checkout clj-documint.</li>
</ul>
<h2><a href="#development" name="development"></a>Development</h2>
<ul>
  <li>Copy <code>documint.config.json.example</code> to <code>documint.config.json</code> and adjust the configuration to suit your environment. (See below for setting up the keystore and truststore if necessary.)</li>
  <li>Run <code>boot dev</code> to run the hot-reloading development version of the service.
    <p>Any dependencies will be downloaded by boot and afterwards the service should be running:</p>
    <pre><code>2018-06-20 22:41:41.284:INFO:oejs.ServerConnector:clojure-agent-send-off-pool-0: Started ServerConnector@2034342c{HTTP/1.1}{0.0.0.0:3001}
2018-06-20 22:41:41.403:INFO:oejs.ServerConnector:clojure-agent-send-off-pool-0: Started ServerConnector@2efbf813{SSL-http/1.1}{0.0.0.0:3002}
Starting #'documint.systems/dev-system
nREPL server started on port 60120 on host 127.0.0.1 - nrepl://127.0.0.1:60120
Elapsed time: 4.072 sec
</code></pre>
    <p>At this stage it should be possible to interact with the service:</p>
    <pre><code>$ curl -s -L --data '' http://localhost:3001/sessions/ | python -m json.tool
{
  "links": {
    "self": "http://localhost:3001/sessions/90a1c5fc-e295-458d-82fa-3e65038fc690",
    "perform": "http://localhost:3001/sessions/90a1c5fc-e295-458d-82fa-3e65038fc690/perform",
    "store-content": "http://localhost:3001/sessions/90a1c5fc-e295-458d-82fa-3e65038fc690/contents/"
  }
}
</code></pre>
  </li>
</ul>
<h2><a href="#production" name="production"></a>Production</h2>
<p>See <code>Dockerfile</code> and <code>.drone.yml</code> for production deployment details.</p>
<h2><a href="#ssl-and-client-certificate-authentication" name="ssl-and-client-certificate-authentication"></a>SSL and client certificate authentication</h2>
<p>Documint can do client-certification authentication and SSL itself if necessary:</p>
<ul>
  <li>
    <p>Create a self-signed certificate for SSL:</p>
    <pre><code>$ keytool -genkey \
          -keyalg RSA \
          -alias ssl \
          -keystore documint_keystore_dev.jks \
          -validity 3650 \
          -keysize 2048
</code></pre>
  </li>
  <li>
  <p>Obtain a CA certificate. For development purposes the <a href="https://raw.githubusercontent.com/fusionapp/fusion/master/fusion/test/services/data/snake-oil-ca.crt.pem">snake oil CA cert from Fusion</a> is sufficient.</p></li>
  <li>
    <p>Add the CA cert to a truststore, any client requests containing a cert signed by this CA will be accepted:</p>
    <pre><code class="sh">$ keytool -import \
          -file ca.crt.pem \
          -alias some-ca \
          -keystore documint_truststore_uat.jks
</code></pre>
  </li>
</ul></div></div></div></body></html>